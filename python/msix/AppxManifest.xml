<?xml version="1.0" encoding="utf-8"?>
<!--
  MSIX Package Manifest for Microsoft Store submission.

  STATUS: Deferred. Windows Store submission is planned for a future release.
  The Publisher CN=PLACEHOLDER must be replaced with the actual code-signing
  certificate subject before Store submission.

  Build:
    1. Build binaries:  python scripts/build.py all
    2. Pack MSIX:       python scripts/build_msix.py

  Prerequisites:
    - Windows SDK (makeappx.exe, signtool.exe)
    - Code-signing certificate

  The Publisher attribute must match your code-signing certificate subject exactly.
  Replace CN=PLACEHOLDER with your actual certificate CN before Store submission.
  The Version attribute is updated automatically by build_msix.py from pyproject.toml.
-->
<Package
  xmlns="http://schemas.microsoft.com/appx/manifest/foundation/windows10"
  xmlns:uap="http://schemas.microsoft.com/appx/manifest/uap/windows10"
  xmlns:rescap="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities"
  xmlns:desktop="http://schemas.microsoft.com/appx/manifest/desktop/windows10"
  IgnorableNamespaces="uap rescap desktop">

  <Identity
    Name="lobotomoe.Revenant"
    Publisher="CN=PLACEHOLDER, O=Aleksandr Kraiz, L=Yerevan, C=AM"
    Version="0.1.0.0"
    ProcessorArchitecture="x64" />

  <Properties>
    <DisplayName>Revenant</DisplayName>
    <PublisherDisplayName>Aleksandr Kraiz</PublisherDisplayName>
    <Description>Electronic document signing with ARX CoSign</Description>
    <Logo>Assets\StoreLogo.png</Logo>
  </Properties>

  <Dependencies>
    <TargetDeviceFamily
      Name="Windows.Desktop"
      MinVersion="10.0.17763.0"
      MaxVersionTested="10.0.22631.0" />
  </Dependencies>

  <Resources>
    <Resource Language="en-us" />
  </Resources>

  <Applications>
    <!-- GUI Application -->
    <Application
      Id="RevenantGUI"
      Executable="revenant-gui.exe"
      EntryPoint="Windows.FullTrustApplication">
      <uap:VisualElements
        DisplayName="Revenant"
        Description="Electronic document signing with ARX CoSign"
        BackgroundColor="transparent"
        Square150x150Logo="Assets\Square150x150Logo.png"
        Square44x44Logo="Assets\Square44x44Logo.png">
        <uap:DefaultTile
          Wide310x150Logo="Assets\Wide310x150Logo.png"
          Square310x310Logo="Assets\Square310x310Logo.png"
          ShortName="Revenant" />
      </uap:VisualElements>

      <!-- File type associations -->
      <Extensions>
        <uap:Extension Category="windows.fileTypeAssociation">
          <uap:FileTypeAssociation Name="pdf">
            <uap:SupportedFileTypes>
              <uap:FileType>.pdf</uap:FileType>
            </uap:SupportedFileTypes>
            <uap:DisplayName>PDF Document</uap:DisplayName>
          </uap:FileTypeAssociation>
        </uap:Extension>
        <uap:Extension Category="windows.fileTypeAssociation">
          <uap:FileTypeAssociation Name="p7s">
            <uap:SupportedFileTypes>
              <uap:FileType>.p7s</uap:FileType>
            </uap:SupportedFileTypes>
            <uap:DisplayName>PKCS#7 Detached Signature</uap:DisplayName>
          </uap:FileTypeAssociation>
        </uap:Extension>
      </Extensions>
    </Application>

    <!-- CLI Application -->
    <Application
      Id="RevenantCLI"
      Executable="revenant.exe"
      EntryPoint="Windows.FullTrustApplication">
      <uap:VisualElements
        DisplayName="Revenant CLI"
        Description="Revenant command-line interface"
        BackgroundColor="transparent"
        Square150x150Logo="Assets\Square150x150Logo.png"
        Square44x44Logo="Assets\Square44x44Logo.png"
        AppListEntry="none" />
    </Application>
  </Applications>

  <Capabilities>
    <!-- Internet access for CoSign SOAP API -->
    <Capability Name="internetClient" />
    <!-- Full trust for Win32 desktop app -->
    <rescap:Capability Name="runFullTrust" />
  </Capabilities>
</Package>
